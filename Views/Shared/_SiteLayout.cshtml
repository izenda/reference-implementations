@model System.Web.Mvc.ViewMasterPage
<!DOCTYPE html>

@functions {
	private string GetIzendaActionUrl(string pageUrl, params string[] additionalParams)
	{
		var allParams = new List<string>(additionalParams ?? new string[0]);
		var pageUrlNodes = pageUrl.Split(new[] { '?' }, StringSplitOptions.RemoveEmptyEntries);
		if (pageUrlNodes.Length > 1)
			foreach (string paramNode in pageUrlNodes[1].Split(new[] { '&' }, StringSplitOptions.RemoveEmptyEntries))
				allParams.AddRange(paramNode.Split(new[] { '=' }));
		var rv = new RouteValueDictionary();
		for (int index = 1; index < allParams.Count; index += 2)
			rv[allParams[index - 1]] = allParams[index];
		string controller = HttpContext.Current.Request.RequestContext.RouteData.Values["controller"].ToString();
		return Url.Action(pageUrlNodes[0], controller, rv, null);
	}
}

<html>
	<head runat="server">
		<script type="text/javascript" src="./@(Izenda.AdHoc.AdHocSettings.ResourcesProviderUniqueUrlWithDelimiter)js=AdHocQuery"></script>
		<script type="text/javascript">
			ensureIzPidProcessed();
		</script>
		<title>Izenda Reports</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta http-equiv="Expires" content="0" />
		<meta http-equiv="Pragma" content="no-cache" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="robots" content="noindex, follow" />
		<link rel="alternate" type="application/rss+xml" href="" title="Team Blog - RSS" />
		<link rel="stylesheet" type="text/css" href="./@(Izenda.AdHoc.AdHocSettings.ResourcesProviderUniqueUrlWithDelimiter)extres=css.reset2.css" />
		<link rel="stylesheet" type="text/css" href="./@(Izenda.AdHoc.AdHocSettings.ResourcesProviderUniqueUrlWithDelimiter)extres=css.print.css" media="print" />
		<link rel="stylesheet" type="text/css" href="./@(Izenda.AdHoc.AdHocSettings.ResourcesProviderUniqueUrlWithDelimiter)extres=css.fun.css" />
		<link rel="shortcut icon" href="./@(Izenda.AdHoc.AdHocSettings.ResourcesProviderUniqueUrlWithDelimiter)image=ModernImages.report-icon.png" type='image/png' />

		@if (IsSectionDefined("changeableheader"))
		{
			@RenderSection("changeableheader");
		}
		else
		{
			<link rel="stylesheet" type="text/css" href="./@(Izenda.AdHoc.AdHocSettings.ResourcesProviderUniqueUrlWithDelimiter)css=ModernStyles.bootstrap-responsive" />
			<link rel="stylesheet" type="text/css" href="./@(Izenda.AdHoc.AdHocSettings.ResourcesProviderUniqueUrlWithDelimiter)css=ModernStyles.bootstrap" />
			<link rel="stylesheet" type="text/css" href="./@(Izenda.AdHoc.AdHocSettings.ResourcesProviderUniqueUrlWithDelimiter)css=ModernStyles.bootstrap-modals" />
			<link rel="stylesheet" type="text/css" href="./@(Izenda.AdHoc.AdHocSettings.ResourcesProviderUniqueUrlWithDelimiter)css=ModernStyles.bootstrap-override" />
			<script type="text/javascript" src="./@(Izenda.AdHoc.AdHocSettings.ResourcesProviderUniqueUrlWithDelimiter)js=ModernScripts.jquery-1.7.2.min"></script>
			<script type="text/javascript" src="./@(Izenda.AdHoc.AdHocSettings.ResourcesProviderUniqueUrlWithDelimiter)js=ModernScripts.bootstrap-dropdown"></script>
			<script type="text/javascript" src="./@(Izenda.AdHoc.AdHocSettings.ResourcesProviderUniqueUrlWithDelimiter)js=ModernScripts.bootstrap-tab"></script>
			<script type="text/javascript" src="./@(Izenda.AdHoc.AdHocSettings.ResourcesProviderUniqueUrlWithDelimiter)js=ModernScripts.bootstrap-transition"></script>
			<script type="text/javascript" src="./@(Izenda.AdHoc.AdHocSettings.ResourcesProviderUniqueUrlWithDelimiter)js=ModernScripts.bootstrap-modal"></script>
		}
		<link rel="stylesheet" type="text/css" href="./@(Izenda.AdHoc.AdHocSettings.ResourcesProviderUniqueUrlWithDelimiter)extres=css.main.css" />

		@if (IsSectionDefined("header"))
		{
			@RenderSection("header")
		}

		@if (!Izenda.AdHoc.AdHocSettings.ShowDesignLinks)
		{
			string script = "<script type=\"text/javascript\" language=\"javascript\">";
			script += "try { $(document).ready(function() {$('.designer-only').hide(); });}catch(e){}";
			script += " try{ jq$(document).ready(function() {jq$('.designer-only').hide(); });}catch(e){} ";
			script += "</script>";
			@Html.Raw(script);
		}
	</head>

	<body>
		<div class="izenda-layout-wrapper layout">
			<!-- header -->
			<div id="whiteHeader" class="izenda-layout-header header">
				<div class="page" style="font-family: Segoe UI, Tahoma, Verdana, Arial, Helvetica, sans-serif">
					<div class="left-logo">
						<img src="./@(Izenda.AdHoc.AdHocSettings.ResourcesProviderUniqueUrlWithDelimiter)image=ModernImages.bi-logo.png" alt="Business intelligence" />
					</div>
					<div class="right-logo">
						@if (!String.IsNullOrEmpty(Izenda.AdHoc.AdHocSettings.ApplicationHeaderImageUrl))
						{
							<text>
								<a href="http://izenda.com" style="position: relative; top: 4px;"><img class="right-logo" src="@Html.Raw(Izenda.AdHoc.AdHocSettings.ApplicationHeaderImageUrl)" alt="Izenda Reports"/></a>
							</text>
						}
						else
						{
							<text>
								<a href="http://izenda.com" style="position: relative; top: 4px;"><img class="right-logo" src="@(Izenda.AdHoc.AdHocSettings.ApplicationHeaderImageUrl ?? String.Format("./{0}image=ModernImages.IzendaNewLogoBlue.png", Izenda.AdHoc.AdHocSettings.ResourcesProviderUniqueUrlWithDelimiter))" alt="Izenda Reports" /></a>
							</text>
						}
					</div>
					<div class="clearfix"></div>
				</div>
			</div>
			<div class="izenda-layout-middle">
				<div class="izenda-layout-container">
					<div class="top-nav applyStyles" id="blueHeader">
						<div class="page">
							<ul id="topnav" style="margin: 0px; padding: 0px;">
								<li class="top-nav-item" style="vertical-align: top;"><a href="@Izenda.AdHoc.Utility.AppendIzPidParameter(GetIzendaActionUrl(Izenda.AdHoc.AdHocSettings.ReportList))">@Izenda.AdHoc.Utility.GetLocalizedString("Reports")</a></li>
								<li class="top-nav-item" style="vertical-align: top;"><a href="@Izenda.AdHoc.Utility.AppendIzPidParameter(GetIzendaActionUrl(Izenda.AdHoc.AdHocSettings.DashboardViewer, "clear", "1"))">@Izenda.AdHoc.Utility.GetLocalizedString("Dashboards")</a></li>
								@if (Izenda.AdHoc.AdHocSettings.ShowDesignLinks)
								{
								<li class="top-nav-item designer-only btn-group"><a href="@Izenda.AdHoc.Utility.AppendIzPidParameter(GetIzendaActionUrl(Izenda.AdHoc.AdHocSettings.ReportDesignerUrl, "clear", "1", "tab", "Data Sources" ))"><span class="plus">+</span> @Izenda.AdHoc.Utility.GetLocalizedString("New")</a>
									<button type="button" class="btn dropdown-toggle" style="float: none; vertical-align: top; line-height: 20px; background-color: transparent; border: none !important;" data-toggle="dropdown">
										<span class="caret" style="margin-top: 8px; vertical-align: top;"></span>
									</button>
									<ul class="dropdown-menu">
										<li><a href="@Izenda.AdHoc.Utility.AppendIzPidParameter(GetIzendaActionUrl(Izenda.AdHoc.AdHocSettings.ReportDesignerUrl, "clear", "1", "tab", "Data Sources"))">@Izenda.AdHoc.Utility.GetLocalizedString("Report")</a></li>
										  <li><a href="@Izenda.AdHoc.Utility.AppendIzPidParameter(GetIzendaActionUrl(Izenda.AdHoc.AdHocSettings.InstantReport))">@Izenda.AdHoc.Utility.GetLocalizedString("InstantReport")</a></li>
										  <li><a href="@Izenda.AdHoc.Utility.AppendIzPidParameter(GetIzendaActionUrl(Izenda.AdHoc.AdHocSettings.DashboardDesignerUrl, "clear", "1"))">@Izenda.AdHoc.Utility.GetLocalizedString("Dashboard")</a></li>
									</ul>
								</li>
								}
								@if (Izenda.AdHoc.AdHocSettings.ShowSettingsButton)
								{
									<li class="top-nav-item" style="float: right;"><a href="@Izenda.AdHoc.Utility.AppendIzPidParameter(GetIzendaActionUrl(Izenda.AdHoc.AdHocSettings.SettingsPageUrl))" title="Settings"><img class="icon" src="./@(Izenda.AdHoc.AdHocSettings.ResourcesProviderUniqueUrlWithDelimiter)image=ModernImages.settings.png" alt="Settings"></a></li>
								}
							</ul>
							<div class="clearfix"></div>
						</div>
					</div>
					<!-- content -->
					<div class="main-content" id="mainContentDiv">
						@RenderBody()
					</div>
				</div>
			</div>

			<!-- footer -->
			<div class="izenda-layout-footer">
				<small class="copyright">Copyright 2015 Izenda, Inc.</small>
			</div>
		</div>
	</body>
</html>
